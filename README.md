# 🏘️ AI Agent虚拟小镇 - 异步版

一个基于异步架构的AI Agent虚拟小镇项目，支持高并发、Redis缓存和智能任务调度。

## 🎯 项目特色

- **异步架构**: 支持高并发Agent操作，提升系统性能
- **Redis缓存**: 智能缓存Agent状态、记忆和交互历史
- **任务调度**: 智能任务优先级管理和异步执行
- **9个独特AI角色**: Alex程序员、Emma艺术家、Sarah教师等
- **混合模型架构**: 本地Qwen2.5-3B + 云端DeepSeek API动态分流
- **向量记忆系统**: Qdrant + BGE-small-zh-v1.5 语义检索
- **社交网络管理**: 动态关系建立、友谊度评分、智能互动
- **实时性能监控**: 任务队列、缓存状态、系统负载监控

## 🚀 快速开始

### 1. 安装依赖

```bash
# 安装所有依赖
pip install -r requirements.txt
```

### 2. 启动Redis (可选但推荐)

```bash
# Windows用户
双击 start_redis.bat

# 或使用Docker
docker run -d -p 6379:6379 redis:latest

# 或使用WSL
sudo apt install redis-server && redis-server
```

### 3. 启动系统

```bash
# 使用启动脚本选择模式
python run_town.py

# 或直接启动异步模式
python async_terminal_town.py

# 或传统模式
python terminal_town.py

# 或Web界面
python main.py
```
- **Web模式**: 浏览器访问 `http://localhost:8501`

## 🤖 AI Agent介绍

### 👨‍💻 Alex - 程序员
- **性格**: 逻辑思维强，喜欢解决技术问题
- **专长**: 编程、算法、技术学习
- **行为**: 经常在办公室工作，喜欢在咖啡厅思考

### 👩‍🎨 Emma - 艺术家  
- **性格**: 富有创造力，感性丰富
- **专长**: 艺术创作、色彩设计、美学感知
- **行为**: 常在公园寻找灵感，在家中创作

### 👩‍🏫 Sarah - 教师
- **性格**: 耐心友善，善于沟通教学
- **专长**: 教育、知识分享、学习指导
- **行为**: 在图书馆准备课程，与其他Agent分享知识

### 👨‍💼 David - 商人
- **性格**: 精明能干，雄心勃勃，善于社交
- **专长**: 商业策略、投资分析、市场洞察
- **行为**: 在办公室谈生意，咖啡厅建立人脉

### 👩‍🎓 Lisa - 学生
- **性格**: 好奇心强，活泼开朗，热爱学习
- **专长**: 学习新知识，提出问题，吸收经验
- **行为**: 在图书馆学习，向其他Agent请教

### 👴 Mike - 退休人员
- **性格**: 慈祥睿智，经验丰富，乐于分享
- **专长**: 人生智慧、历史经验、人际关系
- **行为**: 在公园散步，与年轻人分享经验

### 👨‍⚕️ John - 医生
- **性格**: 严谨负责，同情心强，关注健康
- **专长**: 医疗知识、健康建议、问题诊断
- **行为**: 在医院工作，关心社区健康

### 👩‍🍳 Anna - 厨师
- **性格**: 热情开朗，富有创造力，用心料理
- **专长**: 烹饪技艺、美食创新、温暖人心
- **行为**: 在餐厅工作，用美食连接人心

### 👨‍🔧 Tom - 机械师
- **性格**: 实用主义，动手能力强，朴实直接
- **专长**: 机械维修、工具使用、问题解决
- **行为**: 在修理店工作，帮助解决实际问题

## 🏗️ 系统架构

### AI核心系统
- **本地模型**: Qwen2.5-3B提供基础推理能力
- **云端增强**: DeepSeek API提供更强的对话能力
- **记忆管理**: 基于向量数据库的长期记忆系统
- **情感模拟**: 动态心情和能量系统

### Web界面特性
- **实时地图**: 2D可视化Agent位置和移动
- **状态监控**: 实时显示Agent状态和行为
- **交互对话**: 与AI Agent进行自然语言对话
- **自主模拟**: Agent自动进行决策和互动

## 🛠️ 技术栈

- **前端**: Streamlit (Python Web框架)
- **AI模型**: Qwen2.5-3B (本地) + DeepSeek API (云端)
- **数据库**: Qdrant (向量数据库)
- **内存管理**: Redis (可选)
- **日志系统**: Python logging

## 🎮 使用指南

### 基础操作
1. **选择Agent**: 点击Agent按钮选择要互动的角色
2. **实时对话**: 在聊天框中与AI Agent对话
3. **控制移动**: 选择目标位置移动Agent
4. **监控状态**: 查看Agent的能量、心情和行为

### 高级功能
1. **自主模拟**: 开启后Agent将自动行动和互动
2. **记忆查看**: 查看Agent的记忆和关系网络
3. **AI测试**: 测试不同AI模型的推理能力
4. **数据导出**: 导出Agent交互数据和行为日志

## 📊 系统监控

- **性能指标**: Agent响应时间、内存使用
- **交互统计**: 对话次数、移动轨迹
- **AI状态**: 模型可用性、API调用状态
- **系统日志**: 详细的运行日志和错误记录

## 🔧 配置说明

### AI模型配置
- 本地模型路径：`model/Qwen2.5-3B/`
- API配置：编辑`.env`文件添加密钥
- 模型切换：在Web界面中可以选择使用的模型

### Agent配置
- Agent个性：`data/agent_profiles/`
- 行为参数：`config/settings.py`
- 记忆设置：`memory/`目录下的配置文件

## 🚨 常见问题

### Q: 启动失败怎么办？
A: 检查Python依赖是否安装完整，确认端口8501未被占用

### Q: AI响应慢怎么优化？
A: 可以关闭本地模型，只使用DeepSeek API，或者升级硬件配置

### Q: 如何添加新的Agent？
A: 在`agents/specific_agents.py`中定义新的Agent类，参考现有实现

### Q: 数据存储在哪里？
A: 所有数据存储在`data/`目录下，包括对话记录和Agent状态

## 📈 开发计划

- [ ] 支持更多AI模型（GPT、Claude等）
- [ ] 3D可视化界面
- [ ] 移动端适配
- [ ] 多语言支持
- [ ] Agent自定义编辑器
- [ ] 导出Unity项目功能

## 📝 更新日志

### v2.0.0 (当前版本)
- ✅ 完整的Web界面实现
- ✅ 真实AI Agent系统集成
- ✅ 自主行为和互动系统
- ✅ 记忆和关系管理
- ✅ 实时状态监控

### v1.0.0 (历史版本)
- Unity 3D原型
- 基础Agent系统
- 简单交互界面

---

**🎉 享受你的AI Agent虚拟小镇之旅！**

如有问题，请查看日志文件或提交Issue。
